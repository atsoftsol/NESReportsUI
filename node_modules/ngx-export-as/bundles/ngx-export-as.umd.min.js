!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("html2canvas"),require("jspdf"),require("xlsx"),require("html-docx-js/dist/html-docx")):"function"==typeof define&&define.amd?define("ngx-export-as",["exports","@angular/core","rxjs","html2canvas","jspdf","xlsx","html-docx-js/dist/html-docx"],t):t(e["ngx-export-as"]={},e.ng.core,e.rxjs,e.html2canvas,e.jsPDF,e.XLSX,e.htmlDocx)}(this,function(e,t,o,a,r,i,l){"use strict";a=a&&a.hasOwnProperty("default")?a["default"]:a,window.html2canvas=a;var n=function(){function e(){}return e.prototype.get=function(e){var t="get"+e.type.toUpperCase();return this[t]?this[t](e):o.Observable.create(function(e){e.error("Export type is not supported.")})},e.prototype.save=function(e,t){e.download=!0,e.fileName=t+"."+e.type,this.get(e).subscribe()},e.prototype.contentToBlob=function(l){return o.Observable.create(function(e){for(var t=l.split(","),o=t[0].match(/:(.*?);/)[1],n=atob(t[1]),r=n.length,a=new Uint8Array(r);r--;)a[r]=n.charCodeAt(r);e.next(new Blob([a],{type:o})),e.complete()})},e.prototype.removeFileTypeFromBase64=function(e){return/^data:[^]*;base64,/g[Symbol.replace](e,"")},e.prototype.addFileTypeToBase64=function(e,t){return"data:"+t+";base64,"+e},e.prototype.downloadFromDataURL=function(t,e){var o=this;this.contentToBlob(e).subscribe(function(e){o.downloadFromBlob(e,t)})},e.prototype.downloadFromBlob=function(e,t){var o=document.createElement("a"),n=window.URL.createObjectURL(e);o.setAttribute("download",t),o.style.display="none",document.body.appendChild(o),o.href=n,o.click(),document.body.removeChild(o)},e.prototype.getPDF=function(n){return o.Observable.create(function(e){var t=new r,o=document.getElementById(n.elementId);t.addHTML(o,function(){n.download?(t.save(n.fileName),e.next()):e.next(t.output("datauristring")),e.complete()})})},e.prototype.getPNG=function(n){var r=this;return o.Observable.create(function(o){var e=document.getElementById(n.elementId);a(e,n.options).then(function(e){var t=e.toDataURL("image/PNG");"png"===n.type&&n.download?(r.downloadFromDataURL(n.fileName,t),o.next()):o.next(t),o.complete()},function(e){o.error(e)})})},e.prototype.getCSV=function(r){var a=this;return o.Observable.create(function(e){var t=document.getElementById(r.elementId),n=[];t.querySelectorAll("table tr").forEach(function(e,t){var o=[];e.querySelectorAll("td, th").forEach(function(e,t){o.push(e.innerText)}),n.push(o.join(","))});var o="data:text/csv;base64,"+btoa(n.join("\n"));r.download?(a.downloadFromDataURL(r.fileName,o),e.next()):e.next(o),e.complete()})},e.prototype.getTXT=function(e){var t=e.fileName.split(".");return e.fileName=t[0]+".txt",this.getCSV(e)},e.prototype.getXLS=function(a){var l=this;return o.Observable.create(function(e){var t=document.getElementById(a.elementId),o=i.utils.table_to_sheet(t,a.options),n=i.utils.book_new();i.utils.book_append_sheet(n,o,a.fileName);var r="data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+i.write(n,{type:"base64"});a.download?(l.downloadFromDataURL(a.fileName,r),e.next()):e.next(r),e.complete()})},e.prototype.getXLSX=function(e){return this.getXLS(e)},e.prototype.getDOCX=function(r){var a=this;return o.Observable.create(function(t){var e="<!DOCTYPE html>"+document.getElementById(r.elementId).outerHTML,o=l.asBlob(e,r.options);if(r.download)a.downloadFromBlob(o,r.fileName),t.next(),t.complete();else{var n=new FileReader;n.onloadend=function(){var e=n.result;t.next(e),t.complete()},n.readAsDataURL(o)}})},e.prototype.getDOC=function(e){return this.getDOCX(e)},e.prototype.getJSON=function(u){var p=this;return o.Observable.create(function(e){for(var t=[],o=[],n=document.getElementById(u.elementId),r=0;r<n.rows[0].cells.length;r++)o[r]=n.rows[0].cells[r].innerHTML.toLowerCase().replace(/ /gi,"");for(var a=1;a<n.rows.length;a++){for(var l=n.rows[a],i={},s=0;s<l.cells.length;s++)i[o[s]]=l.cells[s].innerHTML;t.push(i)}var c=JSON.stringify(t),d="data:text/json;base64,"+btoa(c);u.download?(p.downloadFromDataURL(u.fileName,d),e.next()):e.next(t),e.complete()})},e.prototype.getXML=function(i){var s=this;return o.Observable.create(function(e){for(var t='<?xml version="1.0" encoding="UTF-8"?><Root><Classes>',o=document.getElementById(i.elementId).getElementsByTagName("tr"),n=0;n<o.length;n++){var r=o[n];if(0<r.cells.length){t+='<Class name="'+r.cells[0].textContent+'">\n';for(var a=1;a<r.cells.length;++a)t+="\t<data>"+r.cells[a].textContent+"</data>\n";t+="</Class>\n"}}t+="</Classes></Root>";var l="data:text/xml;base64,"+btoa(t);i.download?(s.downloadFromDataURL(i.fileName,l),e.next()):e.next(l),e.complete()})},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=t.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),s=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{providers:[n]}]}],e}();e.ExportAsService=n,e.ExportAsModule=s,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-export-as.umd.min.js.map